<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Birthday Adventure Game</title>
<style>
/* Mobile-first styling for iPhone 12 */
body {
    margin: 0;
    padding: 0;
    font-family: "Arial", sans-serif;
    background: #d0e7f9;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
}

#game-container {
    width: 375px; /* iPhone 12 width */
    max-width: 95%;
    background: #ffffff;
    border-radius: 15px;
    padding: 15px;
    text-align: center;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

h2 { 
    font-size: 20px;
    margin-bottom: 10px;
}

.riddle-text {
    white-space: pre-line;
    font-size: 16px;
    margin: 15px 0;
    line-height: 1.4;
}

/* Items */
.items { 
    display: flex; 
    justify-content: space-around; 
    margin-top: 15px; 
    flex-wrap: wrap; 
}
.item { 
    font-size: 40px; 
    cursor: pointer; 
    margin: 5px; 
    transition: transform 0.2s; 
}
.item:hover { transform: scale(1.15); }

#checklist { 
    font-weight: bold; 
    margin-top: 10px; 
    font-size: 16px; 
}

/* Inputs */
input[type="text"] {
    padding: 10px;
    font-size: 16px;
    width: 90%;
    border-radius: 8px;
    border: 1px solid #ccc;
    margin-top: 10px;
}

/* Buttons */
button {
    padding: 12px 20px;
    font-size: 16px;
    margin-top: 15px;
    cursor: pointer;
    border: none;
    border-radius: 8px;
    background: #9ccbf4;
    color: #fff;
    transition: 0.2s;
}
button:hover { 
    background: #77b6f2; 
    transform: scale(1.05); 
}

/* Map Interface */
#map-container {
    position: relative;
    margin-top: 15px;
}
#map-container img {
    width: 100%;
    border-radius: 10px;
}

.map-marker {
    position: absolute;
    cursor: pointer;
    font-size: 28px;
    padding: 8px 12px;
    background: rgba(255,255,255,0.9);
    border-radius: 10px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.2);
    transform: translate(-50%, -50%);
}
.map-marker:active {
    transform: translate(-50%, -50%) scale(0.95);
}

/* Sprite */
/* sprite movement */
#sprite {
    position: absolute;
    width: 28px;
    height: 28px;
    background-image: url("images/herface.jpeg");
    background-size: cover;
    background-position: center;
    border-radius: 50%;
    border: 2px solid white;
    transform: translate(-50%, -50%);
    transition: all 0.4s ease;
    z-index: 5;
}

/* map zoom animation */
.map-zoom-in {
    animation: zoomIn 1.2s ease forwards;
}

@keyframes zoomIn {
    0% { transform: scale(0.8); opacity: 0.3; }
    50% { transform: scale(1.2); opacity: 1; }
    100% { transform: scale(1); }
}

/* hotspot marker */
.hotspot {
    position: absolute;
    padding: 8px 12px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.25);
    transform: translate(-50%, -50%);
    cursor: pointer;
    font-size: 18px;
    opacity: 0;
    animation: fadeIn 0.8s ease forwards;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translate(-50%, -45%); }
    to { opacity: 1; transform: translate(-50%, -50%); }
}
</style>
</head>
<body>

<div id="game-container"></div>

<script>
const stages = [
    {
        id: 1,
        title: "üåÖ STAGE 1 ‚Äî Wake Up Quest",
        items: ["ü™•", "üëï", "‚åö", "üëü"],
        riddle: {
            question: `Good morning my love! Your motorbike is waiting for you.\n 
            But before you ride off‚Ä¶ the calendar has a little question for you:\n  
What age are you turning today?`,
            answer: "22"
        },
        map: {
    img: "images/stage1_blk546.png",
    movement: {
        path: [ {x: 10, y: 50}, {x: 50, y: 50} ], // example
        duration: 2000
    },
    zoom: "in",
    message: "Go to your motorbike!",
    hotspot: {
        x: 50,
        y: 60,
        label: "üèçÔ∏è Motorbike",
        link: "https://maps.app.goo.gl/PG8BDqgHpoAgSTm39"
    }
}

    },
    {
        id: 2,
        title: "üèçÔ∏è STAGE 2 ‚Äî Motorbike Meet-Up",
        riddle: {
            question: `Some milestones are historic,\n
and some moments are just ours.\n
Can you name the first Asian country\n
that legalized love for all?`,
            answer: "Taiwan"
        },
        map: {
    img: "images/singapore_map1.jpg",
    message: "Ride to Plaza Singapura!",
    movement: {
        path: [
            { x: 5,  y: 50 },   // START: Far west middle
            { x: 50, y: 66 }    // END: Center, 4/6 from top
        ],
        duration: 2000
    },
    hotspot: {
        x: 52,
        y: 68,
        label: "üçú Da Xi @ Plaza Sing",
        link: "https://maps.app.goo.gl/AYsHQ2M9yetTexvX8"
    }
}

    },
    {
        id: 3,
        title: "üçú STAGE 3 ‚Äî Brunch @ Da Xi, Plaza Sing",
        riddle: {
            question: `Where movies come alive on a silver screen,\n
and laughter echoes in the cozy cinema scene.\n
Just steps away from our brunch,\n
look for the place where stories play in frames.`,
            answer: "The Cathay"
        },
        map: {
            img: "images/singapore_map1.jpg",
            nextLocation: { top: "40%", left: "60%", label: "üé® Stage 4", 
            link: "https://maps.app.goo.gl/GRoAe8zXpuj7L2Em9" }
        }
    },
    {
        id: 4,
        title: "üé® STAGE 4 ‚Äî Pottery at CocoArt",
        riddle: {
            question: `Clay is shaped by touch‚Ä¶\n
but what gives it colour, life, and identity?\n
What‚Äôs the next magic step?`,
            answer: "Paint"
        },
        map: {
            img: "images/singapore_map1.jpg",
            nextLocation: { top: "40%", left: "60%", label: "üé® Stage 4", 
            link: "https://maps.app.goo.gl/Xj4QZ2CrkWEPWKkF6" }
        }
    },
    {
        id: 5,
        title: "üè∫ STAGE 5 ‚Äî Collect Pottery",
        riddle: {
            question: `The cups look different ‚Äî shapes, glaze, lines‚Ä¶\n
but there‚Äôs one thing they‚Äôll always share.\n
What hidden mark do both our pottery cups have?`,
            answer: "D+F"
        },
        map: {
            img: "images/singapore_map1.jpg",
            nextLocation: { top: "40%", left: "60%", label: "üé® Stage 4", 
            link: "https://maps.app.goo.gl/G874hdhyaMDjtLRK6" }
        }
    },
    {
        id: 6,
        title: "üçó STAGE 6 ‚Äî Dinner @ Bored Tacos",
        riddle: {
            question: `We‚Äôve travelled from sunlight to clay to colour.\n
Now guess the place\n
where every story we make together\n
quietly returns to rest.`,
            answer: "Binjai"
        },
        map: {
            img: "images/singapore_map1.jpg",
            nextLocation: { top: "40%", left: "60%", label: "üé® Stage 4", 
            link: "https://maps.app.goo.gl/eyCNSVBmjkgG6E8Z7" }
        }
    },
    {
        id: 7,
        title: "üéÅ STAGE 7 ‚Äî Binjai Hall Surprise Gift",
        review: true
    }
];

let currentStage = 0;
const container = document.getElementById("game-container");

/* -----------------------------
     LOAD A STAGE
------------------------------*/
function loadStage(i) {
    const stage = stages[i];
    container.innerHTML = `<h2>${stage.title}</h2>`;

    if (stage.items) {
        container.innerHTML += `
            <div class="items"></div>
            <div id="checklist">Collected: 0/${stage.items.length}</div>
        `;
        
        const itemsDiv = container.querySelector(".items");
        let collected = 0;

        stage.items.forEach(emoji => {
            const span = document.createElement("span");
            span.classList.add("item");
            span.textContent = emoji;

            span.onclick = () => {
                span.style.visibility = "hidden";
                collected++;
                document.getElementById("checklist").textContent = 
                    `Collected: ${collected}/${stage.items.length}`;

                if (collected === stage.items.length) showRiddle(stage.riddle);
            };

            itemsDiv.appendChild(span);
        });

    } else {
        showRiddle(stage.riddle);
    }
}

/* -----------------------------
     RIDDLE
------------------------------*/
function showRiddle(riddle) {
    container.innerHTML += `
        <div class="riddle-text">${riddle.question}</div>
        <input type="text" id="answer" placeholder="Your answer">
        <button onclick="checkAnswer()">Submit</button>
        <p id="feedback"></p>
    `;
}

function checkAnswer() {
    const user = document.getElementById("answer").value.trim();
    const riddle = stages[currentStage].riddle;
    const feedback = document.getElementById("feedback");

    if (user.toLowerCase() === riddle.answer.toLowerCase()) {
    feedback.textContent = "Correct! üéâ";
    loadMapStage(stages[currentStage]);
    } else {
        feedback.textContent = "Try again ‚ù§Ô∏è";
    }
}

/* -----------------------------
     MAP + SPRITE SLIDE
------------------------------*/
function goNextStage() {
    currentStage++;
    loadStage(currentStage);
}

loadStage(currentStage);

function loadMapStage(stage) {
    container.innerHTML = `
        <h2>üìç Location Unlocked</h2>
        <p>${stage.map.message}</p>
        <div id="map-container" style="position: relative;">
            <img id="map-img" src="${stage.map.img}" class="map-zoom-in" style="width:100%; border-radius:12px;">
            <div id="sprite"></div>
        </div>
    `;

    playMapAnimation(stage);
}

function playMapAnimation(stage) {
    const sprite = document.getElementById("sprite");

    if (!stage.map.movement) {
        // no movement ‚Üí just show hotspot
        setTimeout(() => {
            showHotspot(stage.map.hotspot);
        }, 1200);
        return;
    }

    // Start position (first path coordinate)
    const start = stage.map.movement.path[0];
    sprite.style.left = start.x + "%";
    sprite.style.top = start.y + "%";

    // End position (last path coordinate)
    const end = stage.map.movement.path[1];

    setTimeout(() => {
        sprite.style.transition = `all ${stage.map.movement.duration}ms ease`;
        sprite.style.left = end.x + "%";
        sprite.style.top = end.y + "%";
    }, 300);

    // Show hotspot after movement finishes
    setTimeout(() => {
        showHotspot(stage.map.hotspot);
    }, stage.map.movement.duration + 500);
}

function showHotspot(loc) {
    const mapContainer = document.getElementById("map-container");

    const hotspot = document.createElement("div");
    hotspot.classList.add("hotspot");
    hotspot.style.left = loc.x + "%";
    hotspot.style.top = loc.y + "%";
    hotspot.textContent = loc.label;

    hotspot.addEventListener("click", () => {
    window.open(loc.link, "_blank");
    });

    mapContainer.appendChild(hotspot);

    const nextButton = document.createElement("button");
    nextButton.textContent = "Go to Next Stage ‚ûú";
    nextButton.onclick = goNextStage;
    container.appendChild(nextButton);

}

</script>

</body>
</html>

